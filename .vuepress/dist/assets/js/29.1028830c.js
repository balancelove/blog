(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{391:function(s,t,a){"use strict";a.r(t);var n=a(38),e=Object(n.a)({},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"timing-attack"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#timing-attack","aria-hidden":"true"}},[s._v("#")]),s._v(" Timing Attack")]),s._v(" "),a("blockquote",[a("p",[s._v("这是在工作中一位同事在使用 eslint-security 的时候发现的一个攻击点，中文翻译叫时序攻击，感觉很新奇，所以记录下来。")])]),s._v(" "),a("h2",{attrs:{id:"前言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前言","aria-hidden":"true"}},[s._v("#")]),s._v(" 前言")]),s._v(" "),a("p",[s._v("在一次常规的撸代码的下午，突然 eslint 报错了，what? 经过我多年的撸代码经历，已经很少能让他警告了，这次突然给我报个警告，于是打开控制台一看，"),a("code",[s._v("detect-possible-timing-attacks")]),s._v("，一脸懵逼，这是啥？")]),s._v(" "),a("p",[s._v("于是我又跑到 "),a("a",{attrs:{href:"https://github.com/nodesecurity/eslint-plugin-security",target:"_blank",rel:"noopener noreferrer"}},[a("strong",[s._v("eslint-plugin-security")]),a("OutboundLink")],1),s._v(" 仓库溜达了一圈，发现这个警告的源头，它指向了一篇"),a("a",{attrs:{href:"https://snyk.io/blog/node-js-timing-attack-ccc-ctf/",target:"_blank",rel:"noopener noreferrer"}},[s._v("博客"),a("OutboundLink")],1),s._v(",更详细的信息博客里有提到，不过是英文的。")]),s._v(" "),a("h2",{attrs:{id:"怎么触发这个警告？"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#怎么触发这个警告？","aria-hidden":"true"}},[s._v("#")]),s._v(" 怎么触发这个警告？")]),s._v(" "),a("p",[s._v("当你使用这几个运算符的时候，就有可能触发。")]),s._v(" "),a("p",[s._v("这几个运算符就是 "),a("code",[s._v("==")]),s._v(", "),a("code",[s._v("!=")]),s._v(", "),a("code",[s._v("!==")]),s._v(" 和 "),a("code",[s._v("===")]),s._v("。")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" keywords "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'(('")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'password'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'secret'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'api'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'apiKey'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'token'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'auth'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'pass'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'hash'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("join")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("')|('")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'))'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[s._v("看源代码我们就会知道，当你使用上面的几个运算符加上如上的关键字，就会触发这个警告，比如说：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("inputValue "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),s._v(" password"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'登陆成功'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("这样就触发了这个警告，是不是有点懵，难道不是这么写么？好吧，我原来也是这么想的，但是看了博客介绍发现确实不安全，我们继续往下看。")]),s._v(" "),a("h2",{attrs:{id:"啥叫时序攻击"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#啥叫时序攻击","aria-hidden":"true"}},[s._v("#")]),s._v(" 啥叫时序攻击")]),s._v(" "),a("p",[s._v("OK，我们先看百度咋说的: 在密码学中,时序攻击是一种侧信道攻击,攻击者试图通过分析加密算法的时间执行来推导出密码。每一个逻辑运算在计算机需要时间来执行,根据输入不同,精确测量执行时间,根据执行时间反推出密码。")]),s._v(" "),a("p",[s._v("简而言之，就是攻击者会利用它猜测的密码来试探真实的密码，怎么试探呢？根据你响应的时间，我们都知道，字符串的匹配是需要时间的，如果你第一位都匹配不上，那么他响应的时间就会比第一位密码匹配正确的响应时间快。")]),s._v(" "),a("p",[s._v("可能还是有人不太明白，这里我们举个可能不是很恰当的例子：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 比如说我们的真实密码是 1234")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 为了方便，假设我们比较一个字符的时间为 1s")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1234")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 耗时 1s，因为第一位密码错误，只比较了第一位")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1111")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1234")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 耗时 2s，因为第一位密码是正确的，它比较了两位")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2222")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1234")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 耗时 1s")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 可以看出，1111 响应时间有差异，说明第一位密码是 1，通过这种方法，我们可以去猜测到正确的密码")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("好了看完例子，我想大家应该对这种攻击方法有了大概的认识了。")]),s._v(" "),a("h2",{attrs:{id:"如何防御"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#如何防御","aria-hidden":"true"}},[s._v("#")]),s._v(" 如何防御")]),s._v(" "),a("p",[s._v("讲了这么多关于攻击的，那么我们如何去防御呢？")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("将密码比较时间统一：")]),s._v(" 比如说将密码进行异或，这样无论密码是否正确，它都会将密码全部比较之后，再返回，就没有时间差了。")]),s._v(" "),a("li",[a("strong",[s._v("限制密码尝试次数：")]),s._v(" 我们通过上面也知道要得到正确的密码会尝试很多次，我们只要将密码尝试次数进行限制就可以了。")])]),s._v(" "),a("h2",{attrs:{id:"总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#总结","aria-hidden":"true"}},[s._v("#")]),s._v(" 总结")]),s._v(" "),a("p",[s._v("好了，Timing attack 就讲到这里了，在我们工作中要时时刻刻都要想到安全问题，这不仅是保护公司财产、用户隐私，还关系到自己的小钱钱，哈哈。")]),s._v(" "),a("blockquote",[a("p",[s._v("如果各位看官看的还行，可以到 "),a("a",{attrs:{href:"https://github.com/balancelove/readingNotes",target:"_blank",rel:"noopener noreferrer"}},[s._v("GitHub"),a("OutboundLink")],1),s._v(" 里给我一颗小小的 star 支持一下，谢谢。")])])])},[],!1,null,null,null);t.default=e.exports}}]);